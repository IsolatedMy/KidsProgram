# 前后端接口设计

## 前后端分离原理

摘录一些有用信息.

### 开发模式

1. 产品经历/领导/客户提出需求
2. UI做出设计图
3. 前后端约定接口&数据&参数
4. 前后端并行开发（无强依赖，可前后端并行开发，如果需求变更，只要接口&参数不变，就不用两边都修改代码，开发效率高）
5. 前后端集成
6. 前端页面调整
7. 集成成功
8. 交付

###  请求方式

1. 浏览器发送请求
2. 直接到达html页面（前端控制路由与渲染页面，整个项目开发的权重前移）
3. html页面负责调用服务端接口产生数据（通过ajax等等，后台返回json格式数据，json数据格式因为简洁高效而取代xml）
4. 填充html，展现动态效果，在页面上进行解析并操作DOM。

[原文](https://juejin.im/post/5b71302351882560ea4afbb8)

---

## 前后端接口规范

[这篇文章](https://github.com/f2e-journey/treasure/blob/master/api.md)写得很详细,应该参考并遵守其中提出的规范.这里整理一些重要原则.

通常我们都会采用 REST 方式来提供接口, 使用JSON来传输数据.

前端与后端进行数据交互的统称, 也叫做数据接口, 属于一种远程调用, 一般指前端通过HTTP(ajax)请求获取到的数据或者执行的某项操作. 为确保前后端(工程师)的协作沟通, 一般由前端和后端一起来定义接口的规范, 规范的内容一般包含接口的地址, 接口的输入参数和输出的数据格式(结构), 最终由后端来实现这些规范, 为前端提供符合规范的接口.

### 设计原则

1. 接口返回数据即显示：前端仅做渲染逻辑处理；
2. 渲染逻辑禁止跨多个接口调用；
3. 前端关注交互、渲染逻辑，尽量避免业务逻辑处理的出现；
4. 请求响应传输数据格式：JSON，JSON数据尽量简单轻量，避免多级JSON的出现；

### 协商要点

- 返回统一数据结构
- 空数据情况返回规范
- 调用接口业务失败的常用错误码
- 登录情况如何处理,需要前端针对运行环境判断跳转登陆页面
- 返回数据中图片,页面URL是完整还是部分的
- 返回数据中日期格式
- 大数字防止溢出
- 分页参数和信息
- 接口定义与协作
- 命名规范

### 接口规范

接口需要前后端在开发之前共同商定,确定每一个接口的地址(URL), 输入(request)和输出(response), 必要的时候详细注释每一个字段的含义和数据类型.具体需要定义哪些接口, 可以按照下面的思路来整理

- **资源接口**: 系统涉及到哪些资源, 按照 [RESTful](https://www.cnblogs.com/zhichao123/p/10526750.html) 方式定义的细粒度接口
- **操作接口**: 页面涉及到哪些操作, 例如修改购物车中商品的数量, 更换优惠券等等, 也可以使用 RESTful 方式来定义
- **页面接口**: 页面涉及到太多接口, 如果是一个个地调用, 会需要很多次请求, 有可以影响到前端的性能和用户感知(特别是首屏的体验), 因此可能需要将这些接口的数据合并到一起, 作成一个聚合型接口提供给前端来使用

- 参考一些现有的后端接口通用规范,错误码取值规范,接口实现建议等

[前后端接口通用规范](https://yq.aliyun.com/articles/283282)

---

## 文档编写

接口设计必须提供接口文档,并且文档也应该纳入版本控制.文档类型推荐选择markdown.

API文档编写需要包括：

- 简要描述
- 接口地址
- 请求URL
- 请求方式、参数
- 返回内容及示例
- 返回参数说明
- 错误代码
- 备注

[一个接口文档的示例](https://www.showdoc.cc/demo?page_id=7)